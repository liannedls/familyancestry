{"ast":null,"code":"import byChildren from './byChildren';\nimport arrange from './arrange';\nimport { prop, withType } from '../utils';\nexport default (store => {\n  const createFamily = byChildren(store);\n  const arrangeFamily = arrange(store);\n  const root = store.familiesArray.filter(withType('root'));\n\n  for (const rootFamily of root) {\n    if (!rootFamily.main) continue;\n    let stack = rootFamily.pUnitsWithParents.reverse();\n\n    while (stack.length) {\n      const familyUnit = stack.pop();\n      const family = createFamily(familyUnit.nodes.map(prop('id')));\n      const childFamily = store.getFamily(familyUnit.familyId);\n      family.cID = childFamily.id;\n      family.top = childFamily.top - 2;\n      family.left = childFamily.left + familyUnit.shift;\n      arrangeFamily(family);\n      store.families.set(family.id, family);\n      const nextUnits = family.pUnitsWithParents;\n      if (nextUnits.length) stack = [...stack, ...nextUnits.reverse()];\n    }\n  }\n\n  return store;\n});","map":null,"metadata":{},"sourceType":"module"}