{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _getTransitionTimeMs = _interopRequireDefault(require(\"./getTransitionTimeMs\"));\n\nvar SmoothCollapse = /*#__PURE__*/function (_React$Component) {\n  (0, _inherits2[\"default\"])(SmoothCollapse, _React$Component);\n\n  function SmoothCollapse(props) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, SmoothCollapse);\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(SmoothCollapse).call(this, props));\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_removeTransitionEndListener\", function () {});\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_main\", React.createRef());\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_inner\", React.createRef());\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_onNextTransitionEnd\", function (el, callback) {\n      _this._removeTransitionEndListener();\n\n      var listener = function listener() {\n        _this._removeTransitionEndListener();\n\n        callback();\n      };\n\n      var timeout;\n\n      _this._removeTransitionEndListener = function () {\n        _this._removeTransitionEndListener = function () {};\n\n        clearTimeout(timeout);\n        el.removeEventListener('transitionend', listener);\n      }; // Wait until the transitionend event, or until a timer goes off in\n      // case the event doesn't fire because the browser doesn't support it\n      // or the element is hidden before it happens. The timer is a little\n      // longer than the transition is supposed to take to make sure we don't\n      // cut the animation early while it's still going if the browser is\n      // running it just a little slow.\n\n\n      el.addEventListener('transitionend', listener);\n      var ms = (0, _getTransitionTimeMs[\"default\"])(_this.props.heightTransition) * 1.1 + 500;\n      timeout = setTimeout(listener, ms);\n    });\n    _this.state = {\n      renderInner: props.expanded || SmoothCollapse._visibleWhenClosed(props),\n      closing: false,\n      fullyClosed: !props.expanded,\n      height: props.expanded ? 'auto' : props.collapsedHeight\n    };\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(SmoothCollapse, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._removeTransitionEndListener();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      if (!prevProps.expanded && this.props.expanded) {\n        this._removeTransitionEndListener();\n\n        var mainEl = this._main.current;\n        var innerEl = this._inner.current;\n        if (!mainEl || !innerEl) throw new Error('Should not happen'); // Set the collapser to the target height instead of auto so that it\n        // animates correctly. Then switch it to 'auto' after the animation so\n        // that it flows correctly if the page is resized.\n\n        var targetHeight = \"\".concat(innerEl.clientHeight, \"px\");\n        this.setState({\n          height: targetHeight\n        });\n\n        this._onNextTransitionEnd(mainEl, function () {\n          _this2.setState({\n            height: 'auto'\n          }, function () {\n            if (_this2.props.onChangeEnd) {\n              _this2.props.onChangeEnd();\n            }\n          });\n        });\n      } else if (prevProps.expanded && !this.props.expanded) {\n        this._removeTransitionEndListener();\n\n        if (!this._inner.current) throw new Error('Should not happen');\n        this.setState({\n          height: \"\".concat(this._inner.current.clientHeight, \"px\")\n        }, function () {\n          var mainEl = _this2._main.current;\n          if (!mainEl) throw new Error('Should not happen');\n          mainEl.clientHeight; // force the page layout\n\n          _this2.setState({\n            height: _this2.props.collapsedHeight,\n            closing: true\n          });\n\n          _this2._onNextTransitionEnd(mainEl, function () {\n            _this2.setState({\n              closing: false,\n              fullyClosed: true\n            });\n\n            if (_this2.props.onChangeEnd) {\n              _this2.props.onChangeEnd();\n            }\n          });\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var visibleWhenClosed = SmoothCollapse._visibleWhenClosed(this.props);\n\n      var _this$props = this.props,\n          allowOverflowWhenOpen = _this$props.allowOverflowWhenOpen,\n          children = _this$props.children,\n          collapsedHeight = _this$props.collapsedHeight,\n          eagerRender = _this$props.eagerRender,\n          expanded = _this$props.expanded,\n          heightTransition = _this$props.heightTransition,\n          onChangeEnd = _this$props.onChangeEnd,\n          props = (0, _objectWithoutProperties2[\"default\"])(_this$props, [\"allowOverflowWhenOpen\", \"children\", \"collapsedHeight\", \"eagerRender\", \"expanded\", \"heightTransition\", \"onChangeEnd\"]);\n      var _this$state = this.state,\n          height = _this$state.height,\n          fullyClosed = _this$state.fullyClosed,\n          renderInner = _this$state.renderInner;\n      var innerEl = renderInner ? React.createElement(\"div\", {\n        ref: this._inner,\n        style: {\n          overflow: allowOverflowWhenOpen && height === 'auto' ? 'visible' : 'hidden'\n        }\n      }, children) : null;\n      return React.createElement(\"div\", (0, _extends2[\"default\"])({}, props, {\n        ref: this._main,\n        style: {\n          height: height,\n          overflow: allowOverflowWhenOpen && height === 'auto' ? 'visible' : 'hidden',\n          display: fullyClosed && !visibleWhenClosed ? 'none' : null,\n          transition: \"height \".concat(heightTransition)\n        }\n      }), innerEl);\n    }\n  }], [{\n    key: \"_visibleWhenClosed\",\n    value: function _visibleWhenClosed(props) {\n      return props.eagerRender || parseFloat(props.collapsedHeight) !== 0;\n    }\n  }, {\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      if (props.expanded && (state.closing || state.fullyClosed)) {\n        return {\n          closing: false,\n          fullyClosed: false,\n          renderInner: true\n        };\n      } else if (!props.expanded && (state.closing || state.fullyClosed) && state.height !== props.collapsedHeight) {\n        return {\n          height: props.collapsedHeight,\n          renderInner: state.renderInner || SmoothCollapse._visibleWhenClosed(props)\n        };\n      }\n\n      return null;\n    }\n  }]);\n  return SmoothCollapse;\n}(React.Component);\n\nexports[\"default\"] = SmoothCollapse;\n(0, _defineProperty2[\"default\"])(SmoothCollapse, \"propTypes\", {\n  expanded: _propTypes[\"default\"].bool.isRequired,\n  onChangeEnd: _propTypes[\"default\"].func,\n  collapsedHeight: _propTypes[\"default\"].string,\n  heightTransition: _propTypes[\"default\"].string,\n  className: _propTypes[\"default\"].string,\n  allowOverflowWhenOpen: _propTypes[\"default\"].bool,\n  eagerRender: _propTypes[\"default\"].bool\n});\n(0, _defineProperty2[\"default\"])(SmoothCollapse, \"defaultProps\", {\n  collapsedHeight: '0',\n  heightTransition: '.25s ease',\n  className: '',\n  allowOverflowWhenOpen: false,\n  eagerRender: false\n});","map":{"version":3,"sources":["../src/index.js"],"names":["SmoothCollapse","React","Component","expanded","PropTypes","onChangeEnd","collapsedHeight","heightTransition","className","allowOverflowWhenOpen","eagerRender","bool","renderInner","props","closing","fullyClosed","height","parseFloat","state","listener","callback","clearTimeout","el","ms","timeout","setTimeout","prevProps","prevState","mainEl","innerEl","targetHeight","visibleWhenClosed","children","overflow","display","transition"],"mappings":"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","sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport getTransitionTimeMs from './getTransitionTimeMs';\n\nexport type Props = {\n  children?: React.Node;\n  expanded: boolean;\n  onChangeEnd?: ?() => void;\n  collapsedHeight: string;\n  heightTransition: string;\n  className: string;\n  allowOverflowWhenOpen: boolean;\n  eagerRender: boolean;\n};\ntype State = {\n  renderInner: boolean;\n  closing: boolean;\n  fullyClosed: boolean;\n  height: string;\n};\n\nexport default class SmoothCollapse extends React.Component<Props,State> {\n  _removeTransitionEndListener = () => {};\n  _main = React.createRef<HTMLDivElement>();\n  _inner = React.createRef<HTMLDivElement>();\n  static propTypes = {\n    expanded: PropTypes.bool.isRequired,\n    onChangeEnd: PropTypes.func,\n    collapsedHeight: PropTypes.string,\n    heightTransition: PropTypes.string,\n    className: PropTypes.string,\n    allowOverflowWhenOpen: PropTypes.bool,\n    eagerRender: PropTypes.bool\n  };\n  static defaultProps = {\n    collapsedHeight: '0',\n    heightTransition: '.25s ease',\n    className: '',\n    allowOverflowWhenOpen: false,\n    eagerRender: false\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      renderInner: props.expanded || SmoothCollapse._visibleWhenClosed(props),\n      closing: false,\n      fullyClosed: !props.expanded,\n      height: props.expanded ? 'auto' : props.collapsedHeight\n    };\n  }\n\n  static _visibleWhenClosed(props: Props) {\n    return props.eagerRender || parseFloat(props.collapsedHeight) !== 0;\n  }\n\n  componentWillUnmount() {\n    this._removeTransitionEndListener();\n  }\n\n  static getDerivedStateFromProps(props: Props, state: State) {\n    if (props.expanded && (state.closing || state.fullyClosed)) {\n      return {\n        closing: false,\n        fullyClosed: false,\n        renderInner: true\n      };\n    } else if (!props.expanded && (state.closing || state.fullyClosed) && state.height !== props.collapsedHeight) {\n      return {\n        height: props.collapsedHeight,\n        renderInner: state.renderInner || SmoothCollapse._visibleWhenClosed(props)\n      };\n    }\n    return null;\n  }\n\n  _onNextTransitionEnd = (el: HTMLDivElement, callback: () => void) => {\n    this._removeTransitionEndListener();\n\n    const listener = () => {\n      this._removeTransitionEndListener();\n      callback();\n    };\n\n    let timeout;\n    this._removeTransitionEndListener = () => {\n      this._removeTransitionEndListener = () => {};\n      clearTimeout(timeout);\n      el.removeEventListener('transitionend', listener);\n    };\n\n    // Wait until the transitionend event, or until a timer goes off in\n    // case the event doesn't fire because the browser doesn't support it\n    // or the element is hidden before it happens. The timer is a little\n    // longer than the transition is supposed to take to make sure we don't\n    // cut the animation early while it's still going if the browser is\n    // running it just a little slow.\n    el.addEventListener('transitionend', listener);\n    const ms = getTransitionTimeMs(this.props.heightTransition) * 1.1 + 500;\n    timeout = setTimeout(listener, ms);\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (!prevProps.expanded && this.props.expanded) {\n      this._removeTransitionEndListener();\n\n      const mainEl = this._main.current;\n      const innerEl = this._inner.current;\n      if (!mainEl || !innerEl) throw new Error('Should not happen');\n\n      // Set the collapser to the target height instead of auto so that it\n      // animates correctly. Then switch it to 'auto' after the animation so\n      // that it flows correctly if the page is resized.\n      const targetHeight = `${innerEl.clientHeight}px`;\n      this.setState({\n        height: targetHeight\n      });\n\n      this._onNextTransitionEnd(mainEl, () => {\n        this.setState({\n          height: 'auto'\n        }, () => {\n          if (this.props.onChangeEnd) {\n            this.props.onChangeEnd();\n          }\n        });\n      });\n    } else if (prevProps.expanded && !this.props.expanded) {\n      this._removeTransitionEndListener();\n\n      if (!this._inner.current) throw new Error('Should not happen');\n      this.setState({\n        height: `${this._inner.current.clientHeight}px`\n      }, () => {\n        const mainEl = this._main.current;\n        if (!mainEl) throw new Error('Should not happen');\n\n        mainEl.clientHeight; // force the page layout\n        this.setState({\n          height: this.props.collapsedHeight,\n          closing: true\n        });\n\n        this._onNextTransitionEnd(mainEl, () => {\n          this.setState({\n            closing: false,\n            fullyClosed: true\n          });\n          if (this.props.onChangeEnd) {\n            this.props.onChangeEnd();\n          }\n        });\n      });\n    }\n  }\n\n  render() {\n    const visibleWhenClosed = SmoothCollapse._visibleWhenClosed(this.props);\n    const {\n      allowOverflowWhenOpen, children, collapsedHeight, eagerRender, expanded,\n      heightTransition, onChangeEnd, ...props\n    } = this.props;\n    const {height, fullyClosed, renderInner} = this.state;\n    const innerEl = renderInner ?\n      <div ref={this._inner} style={{\n        overflow: allowOverflowWhenOpen && height === 'auto' ? 'visible' : 'hidden'\n      }}>\n        { children }\n      </div>\n      : null;\n\n    return (\n      <div\n        {...props}\n        ref={this._main}\n        style={{\n          height,\n          overflow: allowOverflowWhenOpen && height === 'auto' ? 'visible' : 'hidden',\n          display: (fullyClosed && !visibleWhenClosed) ? 'none': null,\n          transition: `height ${heightTransition}`\n        }}\n      >\n        {innerEl}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"script"}