{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || Object.assign || function (t) {\n  for (var s, i = 1, n = arguments.length; i < n; i++) {\n    s = arguments[i];\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n  }\n\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar helpers_1 = require(\"./helpers\");\n\nvar styles_1 = require(\"./styles\");\n\nvar types_1 = require(\"./types\");\n\nvar PinchZoomPan =\n/** @class */\nfunction (_super) {\n  __extends(PinchZoomPan, _super);\n\n  function PinchZoomPan(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      transform: {\n        x: 0,\n        y: 0,\n        z: 1\n      },\n      action: types_1.pzpAction.None\n    };\n\n    _this.onTouchStart = function (event) {\n      event.preventDefault();\n\n      if (typeof TouchEvent !== 'undefined' && // IE & EDGE doesn't have TouchEvent\n      event instanceof TouchEvent && event.touches.length === 2) {\n        _this.setState({\n          action: types_1.pzpAction.Pinching\n        });\n\n        _this.currentZ = _this.state.transform.z;\n        _this.currentR = helpers_1.getTouchesRange(event);\n      } else {\n        _this.startMoving(event);\n      }\n    };\n\n    _this.onTouchEnd = function (event) {\n      if (_this.state.action === types_1.pzpAction.Pinching && typeof TouchEvent !== 'undefined' && // IE & EDGE doesn't have TouchEvent\n      event instanceof TouchEvent && event.touches.length === 1) {\n        _this.startMoving(event);\n      } else {\n        _this.setState({\n          action: types_1.pzpAction.None\n        });\n      }\n    };\n\n    _this.onTouchMove = function (event) {\n      event.stopImmediatePropagation();\n      event.preventDefault();\n      var action = _this.state.action;\n      if (action === types_1.pzpAction.Moving) _this.move(event);else if (action === types_1.pzpAction.Pinching) _this.pinch(event);\n    };\n\n    _this.onWheel = function (event) {\n      if (!_this.props.captureWheel && !event.altKey) return;\n      event.preventDefault();\n      event.stopPropagation();\n      var delta = helpers_1.getWheelDelta(event) * -1;\n      var z = helpers_1.limitZoom(_this.state.transform.z + delta, _this.props.min, _this.props.max);\n\n      var _a = _this.getPositionByPoint(z, event.pageX, event.pageY),\n          x = _a.x,\n          y = _a.y;\n\n      _this.setState({\n        transform: _this.updateTransform({\n          x: x,\n          y: y,\n          z: z\n        })\n      });\n    };\n\n    _this.setRoot = function (el) {\n      return _this.root = el;\n    };\n\n    var touch = helpers_1.isTouch();\n    _this.eventsMap = [{\n      name: touch ? 'touchstart' : 'mousedown',\n      handler: _this.onTouchStart\n    }, {\n      name: touch ? 'touchmove' : 'mousemove',\n      handler: _this.onTouchMove\n    }, {\n      name: touch ? 'touchend' : 'mouseup',\n      handler: _this.onTouchEnd\n    }, {\n      name: touch ? 'touchleave' : 'mouseleave',\n      handler: _this.onTouchEnd\n    }, {\n      name: 'touchcancel',\n      handler: _this.onTouchEnd\n    }, {\n      name: 'wheel',\n      handler: _this.onWheel\n    }];\n    return _this;\n  }\n\n  PinchZoomPan.prototype.componentDidMount = function () {\n    this.subscribe();\n    this.init();\n  };\n\n  PinchZoomPan.prototype.componentWillUnmount = function () {\n    this.unsubscribe();\n  };\n\n  PinchZoomPan.prototype.subscribe = function () {\n    var _this = this;\n\n    this.eventsMap.forEach(function (event) {\n      _this.root.addEventListener(event.name, event.handler);\n    });\n  };\n\n  PinchZoomPan.prototype.unsubscribe = function () {\n    var _this = this;\n\n    this.eventsMap.forEach(function (event) {\n      _this.root.removeEventListener(event.name, event.handler);\n    });\n  };\n\n  PinchZoomPan.prototype.init = function () {\n    var rootRect = this.root.getBoundingClientRect();\n    var x = rootRect.width / 2;\n    var y = rootRect.height / 2;\n    this.setState({\n      transform: this.updateTransform({\n        x: x,\n        y: y\n      })\n    });\n  };\n\n  PinchZoomPan.prototype.updateTransform = function (transform) {\n    return __assign({}, this.state.transform, transform);\n  };\n\n  PinchZoomPan.prototype.updateCurrentPos = function (X, Y) {\n    this.currentX = X;\n    this.currentY = Y;\n  };\n\n  PinchZoomPan.prototype.getPositionByPoint = function (zoom, X, Y) {\n    var _a = this.state.transform,\n        x = _a.x,\n        y = _a.y,\n        z = _a.z;\n\n    var _b = this.root.getBoundingClientRect(),\n        left = _b.left,\n        top = _b.top;\n\n    var offsetX = X - left - window.pageXOffset - x;\n    var offsetY = Y - top - window.pageYOffset - y;\n    var ratio = zoom / z;\n    return {\n      x: x - (offsetX * ratio - offsetX),\n      y: y - (offsetY * ratio - offsetY)\n    };\n  };\n\n  PinchZoomPan.prototype.startMoving = function (event) {\n    this.setState({\n      action: types_1.pzpAction.Moving\n    });\n\n    var _a = helpers_1.getClientXY(event),\n        X = _a.X,\n        Y = _a.Y;\n\n    this.updateCurrentPos(X, Y);\n  };\n\n  PinchZoomPan.prototype.move = function (event) {\n    var _a = helpers_1.getClientXY(event),\n        X = _a.X,\n        Y = _a.Y;\n\n    var x = this.state.transform.x - (this.currentX - X);\n    var y = this.state.transform.y - (this.currentY - Y);\n    this.setState({\n      transform: this.updateTransform({\n        x: x,\n        y: y\n      })\n    });\n    this.updateCurrentPos(X, Y);\n  };\n\n  PinchZoomPan.prototype.pinch = function (event) {\n    // webkit\n    var scale = event.scale;\n    var pageX = event.pageX;\n    var pageY = event.pageY; // others\n\n    if (scale === undefined || pageX === undefined || pageY === undefined) {\n      scale = helpers_1.getTouchesRange(event) / this.currentR;\n\n      var _a = helpers_1.getMidXY(event),\n          mX = _a.mX,\n          mY = _a.mY;\n\n      pageX = mX;\n      pageY = mY;\n    }\n\n    var z = helpers_1.limitZoom(this.currentZ * scale, this.props.min, this.props.max);\n\n    var _b = this.getPositionByPoint(z, pageX, pageY),\n        x = _b.x,\n        y = _b.y;\n\n    this.setState({\n      transform: this.updateTransform({\n        x: x,\n        y: y,\n        z: z\n      })\n    });\n  }; // private setRefPoint = (el: HTMLElement | null) =>\n  //   this.refPoint = el as HTMLElement;\n  // private setCanvas = (el: HTMLElement | null) =>\n  //   this.canvas = el as HTMLElement;\n\n\n  PinchZoomPan.prototype.render = function () {\n    var _a = this.state.transform,\n        x = _a.x,\n        y = _a.y,\n        z = _a.z;\n    var transform = \"translate(\" + x + \"px, \" + y + \"px) scale(\" + z + \")\";\n    return React.createElement(\"div\", {\n      ref: this.setRoot,\n      className: this.props.className,\n      style: __assign({}, styles_1.ROOT_STYLES, this.props.style)\n    }, React.createElement(\"div\", {\n      style: __assign({}, styles_1.POINT_STYLES, {\n        transform: transform\n      })\n    }, React.createElement(\"div\", {\n      style: styles_1.CANVAS_STYLES\n    }, this.props.children)), this.props.debug && React.createElement(\"div\", {\n      style: styles_1.DEBUG_STYLES\n    }, JSON.stringify(this.state, null, '  ')));\n  };\n\n  PinchZoomPan.defaultProps = {\n    min: 0.1,\n    max: 3.5\n  };\n  return PinchZoomPan;\n}(React.Component);\n\nexports.default = PinchZoomPan;","map":{"version":3,"sources":["C:/Users/lianne/mygit/familyancestry/node_modules/pinch-zoom-pan/dist/index.js"],"names":["__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","defineProperty","exports","value","React","require","helpers_1","styles_1","types_1","PinchZoomPan","_super","props","_this","state","transform","x","y","z","action","pzpAction","None","onTouchStart","event","preventDefault","TouchEvent","touches","setState","Pinching","currentZ","currentR","getTouchesRange","startMoving","onTouchEnd","onTouchMove","stopImmediatePropagation","Moving","move","pinch","onWheel","captureWheel","altKey","stopPropagation","delta","getWheelDelta","limitZoom","min","max","_a","getPositionByPoint","pageX","pageY","updateTransform","setRoot","el","root","touch","isTouch","eventsMap","name","handler","componentDidMount","subscribe","init","componentWillUnmount","unsubscribe","forEach","addEventListener","removeEventListener","rootRect","getBoundingClientRect","width","height","updateCurrentPos","X","Y","currentX","currentY","zoom","_b","left","top","offsetX","window","pageXOffset","offsetY","pageYOffset","ratio","getClientXY","scale","undefined","getMidXY","mX","mY","render","createElement","ref","className","style","ROOT_STYLES","POINT_STYLES","CANVAS_STYLES","children","debug","DEBUG_STYLES","JSON","stringify","defaultProps","Component","default"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar helpers_1 = require(\"./helpers\");\nvar styles_1 = require(\"./styles\");\nvar types_1 = require(\"./types\");\nvar PinchZoomPan = /** @class */ (function (_super) {\n    __extends(PinchZoomPan, _super);\n    function PinchZoomPan(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            transform: { x: 0, y: 0, z: 1 },\n            action: types_1.pzpAction.None,\n        };\n        _this.onTouchStart = function (event) {\n            event.preventDefault();\n            if (typeof TouchEvent !== 'undefined' && // IE & EDGE doesn't have TouchEvent\n                event instanceof TouchEvent &&\n                event.touches.length === 2) {\n                _this.setState({ action: types_1.pzpAction.Pinching });\n                _this.currentZ = _this.state.transform.z;\n                _this.currentR = helpers_1.getTouchesRange(event);\n            }\n            else {\n                _this.startMoving(event);\n            }\n        };\n        _this.onTouchEnd = function (event) {\n            if (_this.state.action === types_1.pzpAction.Pinching &&\n                typeof TouchEvent !== 'undefined' && // IE & EDGE doesn't have TouchEvent\n                event instanceof TouchEvent &&\n                event.touches.length === 1) {\n                _this.startMoving(event);\n            }\n            else {\n                _this.setState({ action: types_1.pzpAction.None });\n            }\n        };\n        _this.onTouchMove = function (event) {\n            event.stopImmediatePropagation();\n            event.preventDefault();\n            var action = _this.state.action;\n            if (action === types_1.pzpAction.Moving)\n                _this.move(event);\n            else if (action === types_1.pzpAction.Pinching)\n                _this.pinch(event);\n        };\n        _this.onWheel = function (event) {\n            if (!_this.props.captureWheel && !event.altKey)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            var delta = helpers_1.getWheelDelta(event) * -1;\n            var z = helpers_1.limitZoom(_this.state.transform.z + delta, _this.props.min, _this.props.max);\n            var _a = _this.getPositionByPoint(z, event.pageX, event.pageY), x = _a.x, y = _a.y;\n            _this.setState({ transform: _this.updateTransform({ x: x, y: y, z: z }) });\n        };\n        _this.setRoot = function (el) {\n            return _this.root = el;\n        };\n        var touch = helpers_1.isTouch();\n        _this.eventsMap = [\n            { name: touch ? 'touchstart' : 'mousedown', handler: _this.onTouchStart },\n            { name: touch ? 'touchmove' : 'mousemove', handler: _this.onTouchMove },\n            { name: touch ? 'touchend' : 'mouseup', handler: _this.onTouchEnd },\n            { name: touch ? 'touchleave' : 'mouseleave', handler: _this.onTouchEnd },\n            { name: 'touchcancel', handler: _this.onTouchEnd },\n            { name: 'wheel', handler: _this.onWheel },\n        ];\n        return _this;\n    }\n    PinchZoomPan.prototype.componentDidMount = function () {\n        this.subscribe();\n        this.init();\n    };\n    PinchZoomPan.prototype.componentWillUnmount = function () {\n        this.unsubscribe();\n    };\n    PinchZoomPan.prototype.subscribe = function () {\n        var _this = this;\n        this.eventsMap.forEach(function (event) {\n            _this.root.addEventListener(event.name, event.handler);\n        });\n    };\n    PinchZoomPan.prototype.unsubscribe = function () {\n        var _this = this;\n        this.eventsMap.forEach(function (event) {\n            _this.root.removeEventListener(event.name, event.handler);\n        });\n    };\n    PinchZoomPan.prototype.init = function () {\n        var rootRect = this.root.getBoundingClientRect();\n        var x = rootRect.width / 2;\n        var y = rootRect.height / 2;\n        this.setState({ transform: this.updateTransform({ x: x, y: y }) });\n    };\n    PinchZoomPan.prototype.updateTransform = function (transform) {\n        return __assign({}, this.state.transform, transform);\n    };\n    PinchZoomPan.prototype.updateCurrentPos = function (X, Y) {\n        this.currentX = X;\n        this.currentY = Y;\n    };\n    PinchZoomPan.prototype.getPositionByPoint = function (zoom, X, Y) {\n        var _a = this.state.transform, x = _a.x, y = _a.y, z = _a.z;\n        var _b = this.root.getBoundingClientRect(), left = _b.left, top = _b.top;\n        var offsetX = (X - left - window.pageXOffset) - x;\n        var offsetY = (Y - top - window.pageYOffset) - y;\n        var ratio = zoom / z;\n        return {\n            x: x - (offsetX * ratio - offsetX),\n            y: y - (offsetY * ratio - offsetY),\n        };\n    };\n    PinchZoomPan.prototype.startMoving = function (event) {\n        this.setState({ action: types_1.pzpAction.Moving });\n        var _a = helpers_1.getClientXY(event), X = _a.X, Y = _a.Y;\n        this.updateCurrentPos(X, Y);\n    };\n    PinchZoomPan.prototype.move = function (event) {\n        var _a = helpers_1.getClientXY(event), X = _a.X, Y = _a.Y;\n        var x = this.state.transform.x - (this.currentX - X);\n        var y = this.state.transform.y - (this.currentY - Y);\n        this.setState({ transform: this.updateTransform({ x: x, y: y }) });\n        this.updateCurrentPos(X, Y);\n    };\n    PinchZoomPan.prototype.pinch = function (event) {\n        // webkit\n        var scale = event.scale;\n        var pageX = event.pageX;\n        var pageY = event.pageY;\n        // others\n        if (scale === undefined || pageX === undefined || pageY === undefined) {\n            scale = helpers_1.getTouchesRange(event) / this.currentR;\n            var _a = helpers_1.getMidXY(event), mX = _a.mX, mY = _a.mY;\n            pageX = mX;\n            pageY = mY;\n        }\n        var z = helpers_1.limitZoom(this.currentZ * scale, this.props.min, this.props.max);\n        var _b = this.getPositionByPoint(z, pageX, pageY), x = _b.x, y = _b.y;\n        this.setState({ transform: this.updateTransform({ x: x, y: y, z: z }) });\n    };\n    // private setRefPoint = (el: HTMLElement | null) =>\n    //   this.refPoint = el as HTMLElement;\n    // private setCanvas = (el: HTMLElement | null) =>\n    //   this.canvas = el as HTMLElement;\n    PinchZoomPan.prototype.render = function () {\n        var _a = this.state.transform, x = _a.x, y = _a.y, z = _a.z;\n        var transform = \"translate(\" + x + \"px, \" + y + \"px) scale(\" + z + \")\";\n        return (React.createElement(\"div\", { ref: this.setRoot, className: this.props.className, style: __assign({}, styles_1.ROOT_STYLES, this.props.style) },\n            React.createElement(\"div\", { style: __assign({}, styles_1.POINT_STYLES, { transform: transform }) },\n                React.createElement(\"div\", { style: styles_1.CANVAS_STYLES }, this.props.children)),\n            this.props.debug && (React.createElement(\"div\", { style: styles_1.DEBUG_STYLES }, JSON.stringify(this.state, null, '  ')))));\n    };\n    PinchZoomPan.defaultProps = {\n        min: 0.1,\n        max: 3.5,\n    };\n    return PinchZoomPan;\n}(React.Component));\nexports.default = PinchZoomPan;\n"]},"metadata":{},"sourceType":"script"}