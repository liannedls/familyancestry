{"ast":null,"code":"import byParents from './byParents';\nimport arrange from './arrange';\nimport { prop, withType } from '../utils';\nexport default (store => {\n  const createFamily = byParents(store);\n  const arrangeFamily = arrange(store);\n  const root = store.familiesArray.filter(withType('root'));\n\n  for (const rootFamily of root) {\n    let stack = rootFamily.cUnitsWithChildren.reverse();\n\n    while (stack.length) {\n      const familyUnit = stack.pop();\n      const family = createFamily(familyUnit.nodes.map(prop('id')), 'child');\n      const parentFamily = store.getFamily(familyUnit.familyId);\n      family.pID = parentFamily.id;\n      family.top = parentFamily.top + 2;\n      family.left = parentFamily.left + familyUnit.shift;\n      arrangeFamily(family);\n      store.families.set(family.id, family);\n      const nextUnits = family.cUnitsWithChildren;\n      if (nextUnits.length) stack = [...stack, ...nextUnits.reverse()];\n    }\n  }\n\n  return store;\n});","map":null,"metadata":{},"sourceType":"module"}